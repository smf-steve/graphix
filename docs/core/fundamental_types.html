<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Fundamental Types - The Graphix Programming Language</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Graphix Programming Language</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="fundamental-types"><a class="header" href="#fundamental-types">Fundamental Types</a></h1>
<p>Graphix has a few fundamental data types, the Graphix shell is a good way to
explore them by trying out small Graphix expressions. You can run the Graphix
shell by invoking <code>graphix</code> with no arguments.</p>
<h2 id="numbers"><a class="header" href="#numbers">Numbers</a></h2>
<p><code>i32</code>, <code>u32</code>, <code>i64</code>, <code>u64</code>, <code>f32</code>, <code>f64</code>, and <code>decimal</code> are the fundamental
numeric types in Graphix. Literals are written with their type prefixed, except
for <code>i64</code> and <code>f64</code> which are written bare. for example, <code>u32:3</code> is a <code>u32</code>
literal value.</p>
<p><code>decimal</code> is an exact decimal representation for performing financial
calculations without rounding or floating point approximation errors.</p>
<p>The basic arithmetic operations are implemented on all the number types with all
the other number types.</p>
<div class="table-wrapper"><table><thead><tr><th>Operation</th><th>Operator</th></tr></thead><tbody>
<tr><td>Add</td><td>+</td></tr>
<tr><td>Subtract</td><td>-</td></tr>
<tr><td>Multiply</td><td>*</td></tr>
<tr><td>Divide</td><td>/</td></tr>
<tr><td>Mod</td><td>%</td></tr>
</tbody></table>
</div>
<p>The compiler will let you do arithmetic on different types of numbers directly
without casting, however the return type of the operation will be the set of all
the types in the operation, representing that either type could be returned. If
you try to pass this result to a function that wants a specific numeric type, it
will fail at compile time.</p>
<pre><code class="language-graphix">〉1. + 1
-: [i64, f64]
2
〉let f = |x: i64| x * 10
〉f(1. + 1)
error: in expr

Caused by:
    0: at: line: 1, column: 3, in: (f64:1. + i64:1)
    1: at: line: 1, column: 3, in: (f64:1. + i64:1)
    2: type mismatch '_1046: i64 does not contain [i64, f64]
</code></pre>
<p>Division by zero is raised as an error to the nearest error handler (more on
that later) and will be printed to stderr by the shell if it is never handled.
Overflow and underflow are handled by wrapping,</p>
<pre><code class="language-graphix">〉0 / 0

thread 'tokio-runtime-worker' panicked at &lt;rust runtime&gt;:
attempt to divide by zero
-: i64
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
unhandled error: error:"in expr at line: 1, column: 1 attempt to divide by zero"
〉u32:0 - u32:1
-: u32
4294967295
</code></pre>
<p>The thread panic message is an artifact of how the overflow error is handled at
runtime, it is safe to continue using the shell and runtime if such an error
occurs. However the particular arith operation that caused the error will not
update, which may cause problems depending on what your program is doing with
it.</p>
<h4 id="v32-z32-v64-z64"><a class="header" href="#v32-z32-v64-z64">v32, z32, v64, z64</a></h4>
<p>These number types are the same as the normal types except when they
are sent over the wire via netidx (or written to a file) they use
variable width encoding instead of normal encoding. The number of
bytes used varies for 64 bit numbers to between 1 and 10. Small
numbers (below 127) are encoded in 1 byte, larger number use more
bytes. The type correspondence is,</p>
<div class="table-wrapper"><table><thead><tr><th>Compact</th><th>Normal</th></tr></thead><tbody>
<tr><td>v32</td><td>u32</td></tr>
<tr><td>z32</td><td>i32</td></tr>
<tr><td>v64</td><td>u64</td></tr>
<tr><td>z64</td><td>i64</td></tr>
</tbody></table>
</div>
<h3 id="number-sets"><a class="header" href="#number-sets">Number Sets</a></h3>
<p>There are a few sets of number types that classify numbers into various kinds.
<code>Number</code> being the most broad, it contains all the number types. <code>Int</code> contains
only integers, <code>Real</code> contains only reals (decimal plus the two float types),
<code>SInt</code> contains signed integers, <code>UInt</code> contains unsigned integers.</p>
<h2 id="bool"><a class="header" href="#bool">Bool</a></h2>
<p>Boolean literals are written as <code>true</code> and <code>false</code>, and the name of the boolean
type is <code>bool</code>.</p>
<p>Boolean expressions using <code>&amp;&amp;</code>, <code>||</code>, and <code>!</code> are supported. These operators
only operate on <code>bool</code>. They can be grouped with parenthesis. For example,</p>
<pre><code class="language-graphix">〉true &amp;&amp; false
-: bool
false
〉true || false
-: bool
true
〉!true
-: bool
false
〉!1
error: in expr

Caused by:
    0: at: line: 1, column: 2, in: i64:1
    1: type mismatch bool does not contain i64
</code></pre>
<h2 id="duration"><a class="header" href="#duration">Duration</a></h2>
<p>A time duration. The type name is <code>duration</code>, and the literals are written as,
<code>duration:1.0s</code>, <code>duration:1.0ms</code>, <code>duration:1.0us</code>, <code>duration:1.0ns</code>. Durations
can be added, and can be multiplied and divided by scalars.</p>
<pre><code class="language-graphix">〉duration:1.0s + duration:1.0s
-: duration
2.s
〉duration:1.0s * 50
-: duration
50.s
〉duration:1.0s / 50
-: duration
0.02s
</code></pre>
<h2 id="datetime"><a class="header" href="#datetime">DateTime</a></h2>
<p>A date and time in the UTC time zone. The type name is <code>datetime</code> and literals
are written in RFC3339 format inside quotes. For example,
<code>datetime:"2020-01-01T00:00:00Z"</code>. You can add and subtract <code>duration</code> from
<code>datetime</code>.</p>
<pre><code class="language-graphix">〉datetime:"2020-01-01T00:00:00Z" + duration:30.s
-: datetime
2020-01-01 00:00:30 UTC
</code></pre>
<p>You can enter <code>datetime</code> literals in local time and they will be converted to UTC. For example,</p>
<pre><code class="language-graphix">〉datetime:"2020-01-01T00:00:00-04:00"
-: datetime
2020-01-01 04:00:00 UTC
</code></pre>
<h2 id="string"><a class="header" href="#string">String</a></h2>
<p>Strings in Graphix are UTF8 encoded text. The type name is <code>string</code> and the
literal is written in quotes <code>"this is a string"</code>. C style escape sequences are
supported, <code>"this is \" a string with a quote and a \n"</code>. Non printable
characters such as newline will be escaped by default when strings are printed
to the console, you can use <code>print</code> to print the raw string including control
characters.</p>
<h3 id="string-interpolation"><a class="header" href="#string-interpolation">String Interpolation</a></h3>
<p>String literals can contain expressions that will be evaluated and joined to the string,
such expressions are surrounded by unescaped <code>[]</code> in the string. For example,</p>
<pre><code class="language-graphix">〉let row = 1
〉let column = 999
〉"/foo/bar/[row]/[column]"
-: string
"/foo/bar/1/999"
</code></pre>
<p>Values in an interpolation need not be strings, they will be cast to a string
when they are used. You can write a literal <code>[</code> or <code>]</code> in a string by escaping
it.</p>
<pre><code class="language-graphix">〉"this is a string with a \[ and a \] but it isn't an interpolation"
-: string
"this is a string with a [ and a ] but it isn't an interpolation"
</code></pre>
<h2 id="any"><a class="header" href="#any">Any</a></h2>
<p>The <code>Any</code> type is a type that unifies with any other type, it corresponds to the
underlying variant type that represents all values in Graphix (and netidx). It
is not used very often, as it provides very few guarantees, however it has it's
place. For example, <code>Any</code> is the type returned by <code>net::subscribe</code>, indicating
that any valid netidx value can come from the network. Usually the first thing
you do with an <code>Any</code> type is call <code>cast</code> to turn it into the type you expect (or
an error), or use a <code>select</code> expression to match it's type (more on select later).</p>
<h2 id="null"><a class="header" href="#null">Null</a></h2>
<p>Null is nothing, just like in many other languages. Unlike most other languages
<code>null</code> is a type not a catch all. If the type of a value does not include <code>null</code>
then it can't be null. The set <code>['a, null]</code> (alias <code>Option&lt;'a&gt;</code>) is commonly
used to represent things that will sometimes return <code>null</code>.</p>
<h2 id="array"><a class="header" href="#array">Array</a></h2>
<p>Arrays are immutable, contiguous, and homogeneous. They are
parameterized, <code>Array&lt;string&gt;</code> indicates an array of strings. Arrays
are zero indexed <code>a[0]</code> is the first element. Array elements can be
any type, including other arrays at arbitrary levels of nesting. There
is a special <code>array</code> type that acts like <code>Array&lt;Any&gt;</code>, that represents
the fundamental array type in the underlying value representation.
Array literals are written like <code>[x, y, z]</code>. There are many functions
in the <code>array</code> module of the standard library for working with arrays.</p>
<h3 id="array-slicing-and-indexing"><a class="header" href="#array-slicing-and-indexing">Array Slicing and Indexing</a></h3>
<p>Graphix supports array subslicing, the syntax will be familiar to Rust programmers.</p>
<ul>
<li><code>a[2..]</code> a slice from index 2 to the end of the array</li>
<li><code>a[..4]</code> a slice from the beginning of the array to index 3</li>
<li><code>a[1..3]</code> a slice from index 1 to index 2</li>
<li><code>a[-1]</code> the last element in the array</li>
<li><code>a[-2]</code> the second to last element in the array</li>
</ul>
<p><code>..=</code> is not supported however, the second part of the slice will always be the
exclusive bound. Literal numbers can always be replaced with a Graphix
expression, e.g. <code>a[i..j]</code> is perfectly valid.</p>
<h3 id="mutability-and-implementation"><a class="header" href="#mutability-and-implementation">Mutability and Implementation</a></h3>
<p>Arrays are not mutable, like all other Graphix values. All operations that
"change" an array, actually create a new array leaving the old one unchanged.
This is even true of the connect operator, which we will talk more about later.</p>
<p>There are a couple of important notes to understand about the implementation of
Arrays.</p>
<ul>
<li>
<p>Arrays are memory pooled, in almost all cases (besides really huge arrays)
creating an array does not actually allocate any memory, it just reuses a
previously used array that has since become unused. This makes using arrays a
lot more efficient than you might expect.</p>
</li>
<li>
<p>Arrays are contiguous in memory. This means they are generally very
memory efficient, each element is 2 machine words, and O(1) to
access. However there are a few cases where this causes a problem,
such as building up an array by appending one element at a
time. This is sadly an O(n^2) operation on arrays. You may wish to
use another data structure, such as a map (which would be O(n
log(n)) if you need to build a large data structure this way.</p>
</li>
<li>
<p>Array slices are zero copy, and also pooled. They simply create a
light weight view into the array. This means algorithms that
progressively deconstruct an array by slicing are O(N) not O(N^2)
and the constants are very fast.</p>
</li>
</ul>
<h2 id="tuples"><a class="header" href="#tuples">Tuples</a></h2>
<p>Tuples are written <code>(x, y)</code>, they can be of arbitrary length, and each element
may have a different type. Tuples may be indexed using numeric field indexes.
Consider</p>
<pre><code class="language-graphix">let x = (1, 2, 3, 4);
x.0
</code></pre>
<p>Will print 1.</p>
<h2 id="map"><a class="header" href="#map">Map</a></h2>
<p>Maps in Graphix are key-value data structures with O(log(N)) lookup, insert, and
remove operations. Maps are parameterized by their key and value type, for
example <code>Map&lt;string, i64&gt;</code> indicates a map with string keys and integer values.
There are many functions for working with maps in the <code>map</code> standard library
module</p>
<h3 id="map-literals"><a class="header" href="#map-literals">Map Literals</a></h3>
<p>Maps can be constructed using the <code>{key =&gt; value}</code> syntax:</p>
<pre><code class="language-graphix">〉{"a" =&gt; 1, "b" =&gt; 2, "c" =&gt; 3}
-: Map&lt;'_1893: string, '_1895: i64&gt;
{"a" =&gt; 1, "b" =&gt; 2, "c" =&gt; 3}
</code></pre>
<p>Keys and values can be any Graphix type, for example here is a map where the key
is a <code>Map&lt;string, i64&gt;</code>.</p>
<pre><code class="language-graphix">{{"foo" =&gt; 42} =&gt; "foo", {"bar" =&gt; 42} =&gt; "bar"}
-: Map&lt;'_1919: Map&lt;'_1915: string, '_1917: i64&gt;, '_1921: string&gt;
{{"bar" =&gt; 42} =&gt; "bar", {"foo" =&gt; 42} =&gt; "foo"}
</code></pre>
<h3 id="map-indexing"><a class="header" href="#map-indexing">Map Indexing</a></h3>
<p>Maps can be indexed using the <code>map{key}</code> syntax to retrieve values:</p>
<pre><code class="language-graphix">〉let m = {"a" =&gt; 1, "b" =&gt; 2, "c" =&gt; 3}
〉m{"b"}
-: ['_1907: i64, Error&lt;`MapKeyError(string)&gt;]
2
</code></pre>
<p>If a key is not present in the map, indexing returns a <code>MapKeyError</code>:</p>
<pre><code class="language-graphix">〉m{"missing"}
-: ['_1907: i64, Error&lt;`MapKeyError(string)&gt;]
error:["MapKeyError", "map key \"missing\" not found"]
</code></pre>
<h3 id="mutability-and-implementation-1"><a class="header" href="#mutability-and-implementation-1">Mutability and Implementation</a></h3>
<p>Like all Graphix values, maps are immutable. All operations that "change" a map
actually create a new map, leaving the original unchanged. Maps are memory
pooled and very efficient - creating new maps typically reuses existing memory
rather than allocating new memory.</p>
<p>Maps maintain their key-value pairs in a balanced tree structure, ensuring
O(log(N)) performance for all operations regardless of map size.</p>
<h2 id="error"><a class="header" href="#error">Error</a></h2>
<p>Error is the built in error type. It carries a type parameter indicating the
type of error, for example <code>Error&lt;</code>MapKeyError(string)&gt;<code>is an error that carries a ``</code>MapKeyError `` variant. You can access the inner error value
using <code>e.0</code> e.g.,</p>
<pre><code class="language-graphix">〉let e = error(`MapKeyError("no such key"))
〉e.0
-: `MapKeyError(string)
`MapKeyError("no such key")
</code></pre>
<p>More information about dealing with errors is available in the section on error
handling.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../core/overview.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../core/reading_types.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../core/overview.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../core/reading_types.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../theme/graphix-highlight.js"></script>



    </div>
    </body>
</html>
